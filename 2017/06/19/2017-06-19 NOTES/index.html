<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title>2017-06-19 NOTES · H.Lの自习室</title><meta name="description" content="2017-06-19 NOTES - Haolu"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.ico"><link rel="stylesheet" href="/css/gandalfr.css"><link rel="stylesheet" href="https://highlightjs.org/static/demo/styles/solarized-light.css"><link rel="search" type="application/opensearchdescription+xml" href="1l1.lol/atom.xml" title="H.Lの自习室"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="http://oqlwx55ng.bkt.clouddn.com/icon-tech.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BOLG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="https://github.com/zhouhaolu" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">2017-06-19 NOTES</h1><div class="tags"><a href="/tags/LVM/" class="tag-title">#LVM</a></div><div class="post-info">Jun 19, 2017</div><div class="post-content"><p></p><h6>LVM</h6><p></p>
<blockquote>
<p>LVM逻辑卷管理，是一种将一个或多个硬盘的分区在逻辑上集合，相当于一个大硬盘来使用，当硬盘的空间不够使用的时候，可以继续将其它的硬盘的 分区加入其中，这样可以事项一种磁盘空间的动态管理，相对于普通的磁盘分区有很大的灵活性，使用普通的磁盘分区，当一个磁盘的分区空间不够使用的时候，可 能就会带来很大的麻烦。使用LVM在一定程度上就可以解决普通磁盘分区带来的问题。</p>
</blockquote>
<a id="more"></a>
<p><img src="http://or87r09l5.bkt.clouddn.com/LVM.png" alt="image"><br>准备一个磁盘分区</p>
<p><code>fdisk /dev/sdb</code></p>
<p>n 创建三个分区 分别5G</p>
<p>t改变分区类型为8e</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">[][[]root[]@Enn []~[]]$ fdisk /dev/sdc</div><div class="line"> </div><div class="line">WARNING: DOS-compatible mode is deprecated. It&apos;s strongly recommended to</div><div class="line">         switch off the mode (command &apos;c&apos;) and change display units to</div><div class="line">         sectors (command &apos;u&apos;).</div><div class="line"> </div><div class="line">Command (m for help): n</div><div class="line">Command action</div><div class="line">   e   extended</div><div class="line">   p   primary partition (1-4)</div><div class="line">p</div><div class="line">Partition number (1-4): 1</div><div class="line">First cylinder (1-2610, default 1): </div><div class="line">Using default value 1</div><div class="line">Last cylinder, +cylinders or +size&#123;K,M,G&#125; (1-2610, default 2610): +5G</div><div class="line"> </div><div class="line">Command (m for help): n</div><div class="line">Command action</div><div class="line">   e   extended</div><div class="line">   p   primary partition (1-4)</div><div class="line">p</div><div class="line">Partition number (1-4): 2</div><div class="line">First cylinder (655-2610, default 655): </div><div class="line">Using default value 655</div><div class="line">Last cylinder, +cylinders or +size&#123;K,M,G&#125; (655-2610, default 2610): +5G</div><div class="line"> </div><div class="line">Command (m for help): n</div><div class="line">Command action</div><div class="line">   e   extended</div><div class="line">   p   primary partition (1-4)</div><div class="line">p</div><div class="line">Partition number (1-4): 3</div><div class="line">First cylinder (1309-2610, default 1309): </div><div class="line">Using default value 1309</div><div class="line">Last cylinder, +cylinders or +size&#123;K,M,G&#125; (1309-2610, default 2610): +5G</div><div class="line"> </div><div class="line">Command (m for help): p</div><div class="line"> </div><div class="line">Disk /dev/sdc: 21.5 GB, 21474836480 bytes</div><div class="line">255 heads, 63 sectors/track, 2610 cylinders</div><div class="line">Units = cylinders of 16065 * 512 = 8225280 bytes</div><div class="line">Sector size (logical/physical): 512 bytes / 512 bytes</div><div class="line">I/O size (minimum/optimal): 512 bytes / 512 bytes</div><div class="line">Disk identifier: 0x7c8e82b1</div><div class="line"> </div><div class="line">   Device Boot      Start         End      Blocks   Id  System</div><div class="line">/dev/sdc1               1         654     5253223+  83  Linux</div><div class="line">/dev/sdc2             655        1308     5253255   83  Linux</div><div class="line">/dev/sdc3            1309        1962     5253255   83  Linux</div><div class="line"> </div><div class="line">Command (m for help): t</div><div class="line">Partition number (1-4): 1</div><div class="line">Hex code (type L to list codes): 8e            # 修改分区类型为8e，即Linux LVM类型</div><div class="line">Changed system type of partition 1 to 8e (Linux LVM)</div><div class="line"> </div><div class="line">Command (m for help): t</div><div class="line">Partition number (1-4): 2</div><div class="line">Hex code (type L to list codes): 8e</div><div class="line">Changed system type of partition 2 to 8e (Linux LVM)</div><div class="line"> </div><div class="line">Command (m for help): t</div><div class="line">Partition number (1-4): 3</div><div class="line">Hex code (type L to list codes): 8e</div><div class="line">Changed system type of partition 3 to 8e (Linux LVM)</div><div class="line"> </div><div class="line">Command (m for help): p</div><div class="line"> </div><div class="line">Disk /dev/sdc: 21.5 GB, 21474836480 bytes</div><div class="line">255 heads, 63 sectors/track, 2610 cylinders</div><div class="line">Units = cylinders of 16065 * 512 = 8225280 bytes</div><div class="line">Sector size (logical/physical): 512 bytes / 512 bytes</div><div class="line">I/O size (minimum/optimal): 512 bytes / 512 bytes</div><div class="line">Disk identifier: 0x7c8e82b1</div><div class="line"> </div><div class="line">   Device Boot      Start         End      Blocks   Id  System</div><div class="line">/dev/sdc1               1         654     5253223+  8e  Linux LVM</div><div class="line">/dev/sdc2             655        1308     5253255   8e  Linux LVM</div><div class="line">/dev/sdc3            1309        1962     5253255   8e  Linux LVM</div><div class="line"> </div><div class="line">Command (m for help): w</div><div class="line">The partition table has been altered!</div><div class="line"> </div><div class="line">Calling ioctl() to re-read partition table.</div><div class="line">Syncing disks.</div></pre></td></tr></table></figure>
<h6>创建物理卷</h6>

<p>pvcreate /dev/sbd1</p>
<p>pvcreate /dev/sbd2</p>
<p>pvcreate /dev/sbd2</p>
<p>pvdisplay 列出当年物理卷</p>
<p>pvremove /dev/sdb3 删除物理卷</p>
<p>安装LVM</p>
<p><code>yum install -y lvm</code></p>
<p>搜索安装包</p>
<p><code>yum provides &quot;/&quot;*/pvcreate&quot;</code></p>
<h6>创建卷组</h6>

<p>pvs 查看</p>
<p><code>vgcreate vg1 /dev sdb1 /dev/sdb2</code>  创建卷组</p>
<p><code>vgs</code> 查看卷组</p>
<h6>创建逻辑卷</h6>

<p><code>lvcreate -L 100M -n lv1 vg1</code>  创建一个100M的 名字为lv1 从vg1组里面划分出来</p>
<p>格式化</p>
<p><code>mkds.ext4 /dev、vg1/lv1</code> 格式化成EXT4文件格式</p>
<p><code>mount /dev/vg1/lv1 /mnt/</code> 将/vg1/lv1挂载到mnt下</p>
<h6>宽容逻辑卷</h6>

<p><code>resize -L 300M /dev/vg1/lv1</code>重新设置卷大小</p>
<p><code>e2size2fs -f /dev/vg1/lv1</code> 检查洗盘错误</p>
<p><code>resize2fs /dev/vg/1v1</code> 更新逻辑卷信息（ext4执行）</p>
<p><code>xfs_growfs /dev/vg1/lv1</code> xfd文件系统需要执行</p>
</div></article></div></main><footer><div class="paginator"><a href="/2017/06/21/2017-06-21 NOTES/" class="prev">PREV</a><a href="/2017/06/16/2017-06-16 NOTES/" class="next">NEXT</a></div><div id="lv-container" data-id="city" data-uid="MTAyMC8yOTAwNS81NTc0"><script>(function(d, s) {
    var j, e = d.getElementsByTagName(s)[0];

    if (typeof LivereTower === 'function') { return; }

    j = d.createElement(s);
    j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
    j.async = true;

    e.parentNode.insertBefore(j, e);
})(document, 'script');</script><noscript> Please activate JavaScript for write a comment in LiveRe</noscript>
</div><div class="copyright"><p>© undefined - 2017 <a href="1l1.lol">Haolu</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/MikeCoder/hexo-theme-gandalfr" target="_blank">hexo-theme-gandalfr</a>.</p></div></footer></div><script src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script><script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/highlight.min.js" crossorigin="anonymous"></script><script src="//cdn.bootcss.com/jquery/3.1.1/jquery.js" crossorigin="anonymous"></script><script>$(document).ready(function() { $('pre').each(function(i, block) { hljs.highlightBlock(block); }); });</script></body></html>